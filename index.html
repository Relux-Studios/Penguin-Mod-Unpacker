
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Extract the original Snail-IDE project from HTML or zip files generated by various packagers.">
  <meta name="theme-color" content="#ff4c4c">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline'">
  <title>Snail-IDE Unpackager</title>
  <style>
    :root {
      --primary-color: #008000;
      --background-color-light: #f4f4f9;
      --background-color-dark: #111;
      --text-color-light: #333;
      --text-color-dark: #eee;
      --accent-color: #4af;
      font-family: 'Inter', sans-serif;
    }
    
    body {
      margin: 0;
      padding: 0;
      background-color: var(--background-color-light);
      color: var(--text-color-light);
      font-size: 16px;
      line-height: 1.6;
    }
    
    @media (prefers-color-scheme: dark) {
      body {
        background-color: var(--background-color-dark);
        color: var(--text-color-dark);
      }
      a {
        color: var(--accent-color);
      }
    }

    main {
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    h1, h2, h3 {
      font-weight: 600;
      color: var(--primary-color);
    }

    p {
      margin-bottom: 1em;
    }

    .file-input {
      width: 100%;
      padding: 10px;
      margin: 20px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }

    .notice {
      padding: 10px;
      background-color: rgba(255, 0, 0, 0.1);
      border-left: 4px solid red;
      margin-bottom: 1em;
      border-radius: 4px;
    }

    .drag-effect {
      opacity: 0;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      border: 10px dashed rgb(110, 110, 255);
      pointer-events: none;
      transition: opacity 0.2s;
    }

    .dragging .drag-effect {
      opacity: 1;
    }

    .download-section a {
      display: block;
      margin: 10px 0;
      padding: 10px;
      background-color: var(--primary-color);
      color: #fff;
      text-align: center;
      text-decoration: none;
      border-radius: 4px;
      transition: background-color 0.3s;
    }

    .download-section a:hover {
      background-color: darkred;
    }

    ul {
      margin-left: 20px;
    }
  </style>
</head>

<body>
  <main>
    <h1>Snail-IDE Unpackager</h1>

    <noscript><p class="notice">This unpackager requires JavaScript to function properly.</p></noscript>

    <p>Select or drop an HTML or zip file, and the unpackager will try to extract the original Snail-IDE project.</p>

    <input type="file" class="file-input" accept=".zip, .html" multiple autocomplete="off">

     <p class="notice">This Unpackager Was Not Fully Made By Me. over 95 Of The code Has Been Fully Changed. Credit To Turbowarp. But Mine Runs Way More Smoother then theres could ever</p>
    
    <p class="notice">This Unpackager is created by Relux Studios, also known as Relux Games. For support, DM me on Discord. Username: relux_games_backup2.</p>

    <p class="notice">Warning: This converts files to .sb3 format. The .snail format in Snail-IDE is just a layer on .sb3 files, which are reconverted when packaging. You can load .sb3 files in Snail-IDE.</p>

    <div class="download-section"></div>

    <p class="notice">Ensure that you have legal permission to unpackage and modify projects. Check with the creator for more information.</p>

    <h2>Supported packagers</h2>
    <ul>
      <li><a href="https://packager.turbowarp.org/">TurboWarp Packager</a> - HTML, zip, exe</li>
      <li><a href="https://forkphorus.github.io/packager/">forkphorus packager</a> - HTML, zip, NW.js</li>
      <li><a href="https://snail-ide.js.org/Snail-IDE-Packager/">Snail-IDE Packager</a> - HTML, zip, exe</li>
      <li><a href="https://sheeptester.github.io/htmlifier/">HTMLifier</a> - HTML, zip</li>
    </ul>

    <h2>Code</h2>
    <p>Snail-IDE Unpackager is <a href="https://github.com/Relux-Studios/Snail-ide-Unpackager">Open Source</a>.</p>

    <h2>Privacy</h2>
    <p>Files are processed locally on your computer and never sent to any server.</p>

    <h2>Concerns About Unpackaging</h2>
    <p>This unpackager works similarly to how projects are packaged. Learn about "DRM" if youâ€™re concerned about people accessing your content.</p>

    <p class="notice">Load and play files directly on this website at: <a href="https://relux-studios.github.io/Scratch-PenguinMod-Snail-Loader/">Scratch PenguinMod Snail Loader</a></p>

    <embed type="text/html" src="loader.html" width="667" height="375">
  </main>

  <div class="drag-effect"></div>

  <script src="dependencies/jszip.min.js"></script>
  <script src="unpackager.js"></script>
  <script>
    (function () {
      'use strict';

      const fileInput = document.querySelector('.file-input');
      const downloadSection = document.querySelector('.download-section');

      const processFile = async (file) => {
        const unpackaged = await unpackage(file);
        const type = unpackaged.type;
        const data = unpackaged.data;
        const name = `${file.name}.${type}`;

        const blob = new Blob([data], {
          type: `application/x.scratch.${type}`
        });
        blob.name = name;
        return blob;
      };

      const processInput = async () => {
        const file = fileInput.files[0];
        if (!file) {
          return;
        }

        while (downloadSection.firstChild) {
          if (downloadSection.firstChild.href) {
            URL.revokeObjectURL(downloadSection.firstChild.href);
          }
          downloadSection.firstChild.remove();
        }

        try {
          for (const file of fileInput.files) {
            const placeholder = document.createElement('span');
            placeholder.textContent = `Processing ${file.name}...`;
            downloadSection.appendChild(placeholder);

            const blob = await processFile(file);

            placeholder.remove();
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = blob.name;
            link.textContent = `Download ${blob.name} (${(blob.size / 1000 / 1000).toFixed(2)}MB)`;
            downloadSection.appendChild(link);
            link.click();
          }
        } catch (e) {
          console.error(e);
          const error = document.createElement('pre');
          error.textContent = (e && e.stack) ? e.stack : e;
          downloadSection.appendChild(error);
          alert(`An error occurred: ${e}`);
        }
      };

      fileInput.addEventListener('change', processInput);

      document.documentElement.addEventListener('drop', (e) => {
        document.documentElement.classList.remove('dragging');
        if (e.dataTransfer.types.includes('Files')) {
          e.preventDefault();
          fileInput.files = e.dataTransfer.files;
          processInput();
        }
      });

      document.documentElement.addEventListener('dragleave', () => {
        document.documentElement.classList.remove('dragging');
      });

      document.documentElement.addEventListener('dragover', (e) => {
        if (e.dataTransfer.types.includes('Files')) {
          document.documentElement.classList.add('dragging');
          e.preventDefault();
          e.dataTransfer.dropEffect = 'copy';
        }
      });
    }());
  </script>
</body>
</html>
